---
import SectionContainer from '@/components/layouts/SectionContainer.astro';
import CapabilityCard from '@/components/ui/CapabilityCard.astro';
import BackgroundDecorations from '@/components/ui/BackgroundDecorations.astro';
import SectionHeader from '@/components/ui/SectionHeader.astro';
import Carousel from '@/components/ui/Carousel.astro';
import type { HomepageContent } from '@/data/content/homepage';

interface Props {
  content: HomepageContent["capabilities"];
}

const { content } = Astro.props;
---

<SectionContainer
  id="capabilities"
  padding="lg"
  background="surface"
  class="relative min-h-auto md:min-h-[75vh] lg:min-h-[80vh] capabilities-section section-divider"
>
  <BackgroundDecorations gradients={["hero"]} />
  
  <div class="grid-container relative z-10">
    <div class="col-span-full max-w-[1400px] mx-auto w-full">
      <div data-reveal="fade-down" data-reveal-duration="600" data-reveal-easing="ease-out-cubic">
        <SectionHeader
          title={content.title}
          subtitle={content.subheading}
          highlight="Capabilities"
          subtitleHighlight="powering"
        />
      </div>

      <div class="hidden lg:block">
        <div class="symmetric-grid-container">
          {content.cards.map((card, index) => (
            <div class="capability-card-wrapper" data-index={index} data-reveal="zoom-in" data-reveal-delay={200 + (index * 100)} data-reveal-duration="600" data-reveal-easing="ease-out-cubic">
              <CapabilityCard
                icon={card.icon}
                title={card.title}
                description={card.description}
                metric={card.metric}
                index={index}
                variant="grid"
              />
            </div>
          ))}
        </div>
      </div>

      <div class="hidden md:grid lg:hidden grid-cols-2 gap-6 col-span-full items-stretch">
        {content.cards.map((card, index) => (
          <div data-reveal="fade-up" data-reveal-delay={200 + (index * 100)} data-reveal-duration="600" data-reveal-easing="ease-out-cubic">
            <CapabilityCard
              icon={card.icon}
              title={card.title}
              description={card.description}
              metric={card.metric}
              index={index}
              variant="grid"
            />
          </div>
        ))}
      </div>

      <Carousel
        containerId="capabilities-carousel-container"
        trackId="capabilities-carousel-track"
        dotSelector=".capabilities-carousel-dot"
        items={content.cards}
        wrapperClass="capabilities-carousel capabilities-carousel-wrapper"
        dotsClass="capabilities-carousel-dots"
        dotClass="capabilities-carousel-dot"
        breakpoint={768}
        activateOnDesktop={false}
      >
        {content.cards.map((card, index) => (
          <div class="carousel-slide embla__slide flex-shrink-0" data-index={index}>
            <CapabilityCard
              icon={card.icon}
              title={card.title}
              description={card.description}
              metric={card.metric}
              index={index}
              variant="carousel"
            />
          </div>
        ))}
      </Carousel>
    </div>
  </div>
</SectionContainer>

<script>
  import { autoInitCarousels } from '@/scripts/sections/autoInit';
  autoInitCarousels();
</script>

