---
import SectionContainer from '@/components/layouts/SectionContainer.astro';
import Card from '@/components/ui/Card.astro';
import BackgroundDecorations from '@/components/ui/BackgroundDecorations.astro';
import SectionHeader from '@/components/ui/SectionHeader.astro';
import Carousel from '@/components/ui/Carousel.astro';
import type { HomepageContent } from '@/data/content/homepage';

interface Props {
  content: HomepageContent["capabilities"];
}

const { content } = Astro.props;
---

<SectionContainer
  id="capabilities"
  padding="lg"
  background="surface"
  class="relative capabilities-section section-divider"
>
  <BackgroundDecorations gradients={["hero"]} />
  
  <div class="grid-container relative z-10">
    <div class="col-span-full max-w-[1400px] mx-auto w-full">
      <div data-reveal="fade-down" data-reveal-duration="250" data-reveal-easing="ease-out">
        <SectionHeader
          title={content.title}
          subtitle={content.subheading}
          highlight="Capabilities"
          subtitleHighlight="powering"
        />
      </div>

      <div class="hidden lg:block">
        <div class="symmetric-grid-container gap-6 lg:gap-8">
          {content.cards.map((card, index) => (
            <div class="capability-card-wrapper h-full" data-index={index} data-reveal="zoom-in" data-reveal-delay={index * 50} data-reveal-duration="250" data-reveal-easing="ease-out">
              <Card
                variant="capability"
                icon={card.icon}
                title={card.title}
                description={card.description}
                metric={card.metric}
                index={index}
                isCarousel={false}
              />
            </div>
          ))}
        </div>
      </div>

      <div class="hidden md:grid lg:hidden grid-cols-2 gap-6 col-span-full items-stretch">
        {content.cards.map((card, index) => (
          <div data-reveal="fade-up" data-reveal-delay={index * 50} data-reveal-duration="250" data-reveal-easing="ease-out">
            <Card
              variant="capability"
              icon={card.icon}
              title={card.title}
              description={card.description}
              metric={card.metric}
              index={index}
              isCarousel={false}
            />
          </div>
        ))}
      </div>

      <Carousel
        containerId="capabilities-carousel-container"
        trackId="capabilities-carousel-track"
        items={content.cards}
        wrapperClass="capabilities-carousel capabilities-carousel-wrapper px-4 md:px-6"
        breakpoint={768}
        activateOnDesktop={false}
      >
        {content.cards.map((card, index) => (
          <div class="carousel-slide embla__slide flex-shrink-0 flex justify-center" data-index={index}>
            <Card
              variant="capability"
              icon={card.icon}
              title={card.title}
              description={card.description}
              metric={card.metric}
              index={index}
              isCarousel={true}
            />
          </div>
        ))}
      </Carousel>
    </div>
  </div>
</SectionContainer>

<script>
  import { autoInitCarousels } from '@/scripts/sections/autoInit';
  autoInitCarousels();
</script>

