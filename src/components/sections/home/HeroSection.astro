---
import { Icon } from "astro-icon/components";
import Button from "@/components/ui/Button.astro";
import HeroLayout from "@/components/ui/HeroLayout.astro";
import type { HomepageContent } from "@/data/content/homepage";
import { createUrl } from "@/utils/url";
import { shouldOpenCalendly } from "@/utils/ctaRules";

interface Props {
  content: HomepageContent["hero"];
}

const { content } = Astro.props;

const ctaText = content.primaryCta?.text || "Learn more";
const ctaHref = content.primaryCta?.href || "about";
const shouldOpenCalendlyBtn = shouldOpenCalendly({
  text: ctaText,
  href: ctaHref,
  context: 'hero'
});

const cta = {
  text: ctaText,
  href: shouldOpenCalendlyBtn ? undefined : createUrl(ctaHref),
  variant: "primary" as const,
  googleCalendar: shouldOpenCalendlyBtn,
};
---

<HeroLayout
  id="hero"
  scrollHref="#services-intro"
  scrollText={content.scrollIndicator}
  scrollAriaLabel={content.scrollIndicator}
>
  <div class="hero-headline mb-6 sm:mb-8 lg:mb-10 w-full" data-aos="fade-down" data-aos-duration="700" data-aos-easing="ease-out-cubic">
    <h1
      class="hero-headline-text text-h1 font-extrabold leading-tight tracking-tight text-theme-primary transition-colors mb-4 sm:mb-6 lg:mb-8 w-full font-display"
    >
      <span class="block home-hero-title">{content.title}</span>
      <span class="block mt-2 sm:mt-3 lg:mt-4" data-aos="zoom-in" data-aos-delay="150" data-aos-duration="600" data-aos-easing="ease-out-cubic">
        <span class="highlight-gradient home-hero-highlight inline-block">{content.titleHighlight}</span>
      </span>
    </h1>
  </div>

  {content.subtitle && (
    <div class="hero-subtitle mb-8 sm:mb-10 lg:mb-12 max-w-[500px] sm:max-w-[600px] lg:max-w-[700px] mx-auto hero-follow-content" data-aos="fade-up" data-aos-delay="250" data-aos-duration="600" data-aos-easing="ease-out-cubic">
      <p class="text-body-lg sm:text-body-xl text-theme-secondary leading-relaxed transition-colors font-normal opacity-80 font-body">
        {content.subtitle}
      </p>
    </div>
  )}

  <div class="hero-follow-content" data-aos="fade-up" data-aos-delay="350" data-aos-duration="600" data-aos-easing="ease-out-cubic">
    <div class="hero-cta-container">
      <Button
        variant={cta.variant}
        size="lg"
        href={cta.href}
        googleCalendar={cta.googleCalendar}
        class="hero-cta-button group/btn"
      >
        <span class="whitespace-nowrap">{cta.text}</span>
        <Icon
          name="mdi:arrow-right"
          class="w-4 h-4 flex-shrink-0 group-hover/btn:translate-x-1 transition-transform duration-300"
        />
      </Button>
    </div>
  </div>
</HeroLayout>


