---
import { Icon } from "astro-icon/components";
import HighlightText from '@/components/ui/HighlightText.astro';
import BackgroundDecorations from '@/components/ui/BackgroundDecorations.astro';
import Button from '@/components/ui/Button.astro';
import HeroLayout from '@/components/ui/HeroLayout.astro';
import type { ServiceDetail } from '@/data/content/services';
import { shouldOpenCalendly } from '@/utils/ctaRules';

interface Props {
  service: ServiceDetail;
}

const { service } = Astro.props;
const shouldOpenCalendlyBtn = shouldOpenCalendly({
  text: service.cta.ctaText,
  href: service.cta.ctaHref,
  context: 'service'
});
---

<HeroLayout
  id="service-hero"
  class="service-hero-section"
  scrollHref="#service-overview"
  scrollText="Learn More"
  scrollAriaLabel="Scroll to learn more"
>
  <Fragment slot="background">
    <BackgroundDecorations gradients={["hero", "dual"]} patterns={["grid"]} />

    <div class="absolute inset-0 overflow-hidden pointer-events-none"></div>
  </Fragment>

  <div class="service-hero-headline mb-6 sm:mb-8 lg:mb-10 w-full">
    <h1
      class="text-h1 font-extrabold leading-tight tracking-tight text-theme-primary transition-colors mb-3 sm:mb-4 lg:mb-5 w-full font-display"
      data-reveal="fade-down"
      data-reveal-duration="250"
      data-reveal-easing="ease-out"
    >
      <HighlightText
        text={service.hero.title}
        highlight={service.hero.title.split(' ').slice(-2)}
        highlightClass="text-accent-green"
      />
    </h1>
    <p
      class="text-body-lg sm:text-body-xl text-theme-secondary leading-relaxed transition-colors font-normal opacity-80 font-body max-w-[500px] sm:max-w-[600px] lg:max-w-[700px] mx-auto"
      data-reveal="fade-up"
      data-reveal-delay="100"
      data-reveal-duration="250"
      data-reveal-easing="ease-out"
    >
      {service.hero.subtitle}
    </p>
  </div>

  <div
    class="service-hero-description mb-8 sm:mb-10 lg:mb-12 max-w-[500px] sm:max-w-[600px] lg:max-w-[700px] mx-auto service-hero-follow-content hero-follow-content"
    data-reveal="fade-up"
    data-reveal-delay="200"
    data-reveal-duration="250"
    data-reveal-easing="ease-out"
  >
    <p class="text-body-base sm:text-body-lg text-theme-secondary/90 leading-relaxed font-body">
      <HighlightText
        text={service.hero.description}
        highlight={service.hero.descriptionHighlight || []}
        highlightClass="text-accent-green font-semibold"
      />
    </p>
  </div>
  <div
    class="service-hero-follow-content hero-follow-content"
    data-reveal="fade-up"
    data-reveal-delay="300"
    data-reveal-duration="250"
    data-reveal-easing="ease-out"
  >
    <div class="hero-cta-container">
      <Button
        variant="primary"
        size="lg"
        href={shouldOpenCalendlyBtn ? undefined : service.cta.ctaHref}
        googleCalendar={shouldOpenCalendlyBtn}
        class="hero-cta-button group/btn"
      >
        <span class="whitespace-nowrap">{shouldOpenCalendlyBtn ? "Book a Consultation" : service.cta.ctaText}</span>
        <Icon name="mdi:arrow-right" class="w-4 h-4 flex-shrink-0 group-hover/btn:translate-x-1 transition-transform duration-300" />
      </Button>
    </div>
  </div>
</HeroLayout>

