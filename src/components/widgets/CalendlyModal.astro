---
import { Icon } from "astro-icon/components";
---

<div id="calendly-modal" class="calendly-modal hidden fixed inset-0 bg-theme-primary/95 backdrop-blur-md" aria-hidden="true" aria-labelledby="calendly-modal-title" style="z-index: 99999;">
  <div class="calendly-modal-overlay absolute inset-0 bg-theme-primary/80" data-calendly-close></div>
  <div class="calendly-modal-container relative w-full h-full flex items-center justify-center p-0 sm:p-4 lg:p-6">
    <button
      id="calendly-modal-close"
      class="calendly-modal-close absolute top-3 right-3 sm:top-4 sm:right-4 lg:top-6 lg:right-6 z-20 w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-theme-card border-2 border-accent-green/30 hover:border-accent-green hover:bg-accent-green/10 flex items-center justify-center transition-all duration-300 group shadow-lg"
      aria-label="Close calendar"
      data-calendly-close
    >
      <Icon name="mdi:close" class="w-5 h-5 sm:w-6 sm:h-6 text-theme-primary group-hover:text-accent-green transition-colors" />
    </button>
    
    <div class="calendly-modal-content w-full h-full bg-theme-card border-0 sm:border border-accent-green/20 shadow-2xl overflow-hidden flex flex-col rounded-none sm:rounded-2xl">
      <div id="calendly-widget-container" class="flex-1 w-full h-full min-h-0">
        <div
          id="calendly-widget"
          class="calendly-inline-widget w-full h-full"
        ></div>
      </div>
    </div>
  </div>
</div>

<style>
  .calendly-modal {
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
  }

  .calendly-modal.show {
    opacity: 1;
    pointer-events: all;
  }

  .calendly-modal-container {
    animation: fadeIn 0.3s ease;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: scale(0.95);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  .calendly-modal-close {
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
  }

  .calendly-modal-content {
    animation: slideUp 0.3s ease;
    height: 100dvh !important;
    width: 100dvw !important;
    max-height: 100dvh !important;
    max-width: 100dvw !important;
  }

  @keyframes slideUp {
    from {
      transform: translateY(20px);
      opacity: 0;
    }
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }

  #calendly-widget-container {
    position: relative !important;
    width: 100% !important;
    height: 100% !important;
    min-height: 0 !important;
    overflow: hidden !important;
    display: flex !important;
    flex-direction: column !important;
  }

  .calendly-inline-widget {
    width: 100% !important;
    height: 100% !important;
    min-height: 0 !important;
    display: flex !important;
    flex-direction: column !important;
  }

  :global(.calendly-inline-widget > div) {
    flex: 1 !important;
    min-height: 0 !important;
    display: flex !important;
    flex-direction: column !important;
    width: 100% !important;
    height: 100% !important;
  }

  :global(.calendly-inline-widget iframe) {
    width: 100% !important;
    height: 100% !important;
    min-height: 0 !important;
    min-width: 0 !important;
    border: none !important;
    border-radius: 0 !important;
    flex: 1 !important;
    display: block !important;
  }

  .calendly-modal-container {
    width: 100dvw !important;
    height: 100dvh !important;
    max-width: 100dvw !important;
    max-height: 100dvh !important;
    padding: 0 !important;
  }

  .calendly-modal-content {
    border-radius: 0 !important;
    border: none !important;
  }

  .calendly-modal-close {
    z-index: 100000 !important;
  }

  @media (max-width: 640px) {
    .calendly-modal-close {
      top: 0.75rem;
      right: 0.75rem;
      width: 2.5rem;
      height: 2.5rem;
    }
  }
</style>
