---
export interface Props {
  variant?: 'text' | 'title' | 'avatar' | 'card' | 'image' | 'button';
  width?: string;
  height?: string;
  class?: string;
  rounded?: boolean;
}

const {
  variant = 'text',
  width,
  height,
  class: className = '',
  rounded = false,
} = Astro.props;

const getDefaultDimensions = () => {
  switch (variant) {
    case 'title':
      return { width: '60%', height: '2rem' };
    case 'text':
      return { width: '100%', height: '1rem' };
    case 'avatar':
      return { width: '3rem', height: '3rem' };
    case 'card':
      return { width: '100%', height: '20rem' };
    case 'image':
      return { width: '100%', height: '12rem' };
    case 'button':
      return { width: '8rem', height: '2.5rem' };
    default:
      return { width: '100%', height: '1rem' };
  }
};

const defaults = getDefaultDimensions();
const finalWidth = width || defaults.width;
const finalHeight = height || defaults.height;
const isRounded = rounded || variant === 'avatar';
---

<div
  class={`skeleton ${className}`}
  style={`width: ${finalWidth}; height: ${finalHeight};`}
  data-variant={variant}
  data-rounded={isRounded}
  aria-hidden="true"
  aria-label="Loading..."
></div>

<style>
  .skeleton {
    background: linear-gradient(
      90deg,
      var(--bg-surface) 0%,
      var(--bg-card) 50%,
      var(--bg-surface) 100%
    );
    background-size: 200% 100%;
    animation: pulse 1.5s ease-in-out infinite;
    border-radius: 0.375rem;
  }

  .skeleton[data-rounded="true"] {
    border-radius: 9999px;
  }

  .skeleton[data-variant="card"] {
    border-radius: 1rem;
  }

  @keyframes pulse {
    0% {
      background-position: 200% 0;
    }
    100% {
      background-position: -200% 0;
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .skeleton {
      animation: none;
      background: var(--bg-surface);
    }
  }
</style>
