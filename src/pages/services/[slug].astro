---
import ServiceLayout from "@/layouts/ServiceLayout.astro";
import ServiceHeroSection from "@/components/sections/services/ServiceHeroSection.astro";
import ServiceOverviewSection from "@/components/sections/services/ServiceOverviewSection.astro";
import ServiceBenefitsSection from "@/components/sections/services/ServiceBenefitsSection.astro";
import ServiceProcessSection from "@/components/sections/services/ServiceProcessSection.astro";
import ServiceOutcomesSection from "@/components/sections/services/ServiceOutcomesSection.astro";
import ServiceCtaSection from "@/components/sections/services/ServiceCtaSection.astro";
import { getServicesContent, getServiceDetailBySlug } from "@/lib/sanity/data";

export async function getStaticPaths() {
  const servicesContent = await getServicesContent();
  return servicesContent.details.map((service) => ({
    params: { slug: service.slug },
  }));
}

const { slug } = Astro.params;

if (!slug) {
  return new Response(null, { status: 404, statusText: "Service not found" });
}

const service = await getServiceDetailBySlug(slug);

if (!service) {
  return new Response(null, { status: 404, statusText: "Service not found" });
}
---

<ServiceLayout title={`${service.name} | AUXO Data Labs`} description={service.hero.description} serviceName={service.name}>
  <ServiceHeroSection service={service} slot="hero" />
  <ServiceOverviewSection service={service} slot="overview" />
  <ServiceBenefitsSection service={service} slot="benefits" />
  <ServiceProcessSection service={service} slot="process" />
  <ServiceOutcomesSection service={service} slot="outcomes" />
  <ServiceCtaSection service={service} slot="cta" />
</ServiceLayout>

