---
import BaseLayout from "@/layouts/BaseLayout.astro";
import { getSiteConfigData } from "@/lib/sanity/siteConfig";
import { Icon } from "astro-icon/components";
import BackgroundDecorations from "@/components/ui/BackgroundDecorations.astro";
import ContactForm from "@/components/forms/ContactForm.astro";

const siteData = await getSiteConfigData();
---

<BaseLayout
  title="Contact Us | AUXO Data Labs"
  description="Get in touch with AUXO Data Labs. We're here to help transform your data analytics capabilities. Contact us for inquiries, consultations, or partnerships."
  showParticles={false}
>
  <section
    id="contact-main"
    class="relative w-full min-h-screen flex items-center justify-center overflow-hidden py-12 sm:py-20 lg:py-24 px-4 sm:px-6"
  >
    <BackgroundDecorations gradients={["hero"]} patterns={["grid"]} />

    <div class="grid-container relative z-10 w-full">
      <div class="col-span-full max-w-7xl mx-auto w-full">
        <div class="text-center mb-10 sm:mb-12 lg:mb-16">
          <h1 class="text-h1 font-extrabold mb-4 sm:mb-5 lg:mb-6 leading-tight tracking-tight text-theme-primary font-display" data-reveal="fade-down" data-reveal-duration="600" data-reveal-easing="ease-out-cubic">
            Let's <span class="text-accent-green font-black text-[1.05em]">Connect</span>
          </h1>
          <p class="text-body-lg sm:text-body-xl text-theme-secondary leading-relaxed max-w-2xl mx-auto font-body mb-8 sm:mb-10" data-reveal="fade-up" data-reveal-delay="100" data-reveal-duration="500" data-reveal-easing="ease-out-cubic">
            Ready to transform your data analytics? Start with a conversation.
          </p>
          <div class="flex justify-center" data-reveal="zoom-in" data-reveal-delay="200" data-reveal-duration="500" data-reveal-easing="ease-out-cubic">
            <button
              type="button"
              data-google-calendar-open
              class="px-8 py-4 bg-accent-green text-black font-bold rounded-xl hover:bg-accent-green/90 hover:shadow-lg hover:shadow-accent-green/30 hover:-translate-y-0.5 active:translate-y-0 transition-all duration-300 min-h-[56px] flex items-center justify-center gap-3 text-lg group/btn"
              aria-label="Schedule a meeting"
            >
              <Icon name="mdi:calendar-clock" class="w-6 h-6 group-hover/btn:scale-110 transition-transform" />
              <span>Schedule a Meeting</span>
            </button>
          </div>
        </div>

        <div class="grid lg:grid-cols-2 gap-8 lg:gap-12 xl:gap-16" id="contact-form">
          <div class="space-y-6 lg:space-y-8" data-reveal="fade-right" data-reveal-duration="500" data-reveal-delay="200" data-reveal-easing="ease-out-cubic">
            <div class="text-center lg:text-left">
              <h2 class="text-h3 font-extrabold mb-3 text-theme-primary font-display">
                Reach Out
              </h2>
              <p class="text-theme-secondary font-body leading-relaxed max-w-md mx-auto lg:mx-0">
                We typically respond within 24 hours. Share your challenge, and we'll provide insights on how we can help.
              </p>
            </div>

            <div class="space-y-4 max-w-md mx-auto lg:mx-0 lg:max-w-none">
              <a
                href={`mailto:${siteData.email}`}
                class="flex items-center gap-4 p-4 sm:p-5 rounded-xl bg-theme-card border border-accent-green/20 hover:border-accent-green/40 hover:shadow-lg hover:shadow-accent-green/10 hover:-translate-y-0.5 transition-all duration-300 group"
              >
                <div class="w-12 h-12 bg-accent-green/15 rounded-lg flex items-center justify-center flex-shrink-0 group-hover:bg-accent-green/25 group-hover:scale-110 transition-all">
                  <Icon name="mdi:email-outline" class="w-6 h-6 text-accent-green" />
                </div>
                <div class="flex-1 min-w-0">
                  <div class="text-xs font-semibold text-theme-secondary mb-1 font-body uppercase tracking-wide">Email</div>
                  <div class="text-sm sm:text-base font-bold text-theme-primary font-body truncate group-hover:text-accent-green transition-colors">
                    {siteData.email}
                  </div>
                </div>
                <Icon name="mdi:arrow-right" class="w-5 h-5 text-accent-green opacity-0 group-hover:opacity-100 -translate-x-2 group-hover:translate-x-0 transition-all flex-shrink-0" />
              </a>

              <div class="flex items-center gap-4 p-4 sm:p-5 rounded-xl bg-theme-card border border-accent-green/20">
                <div class="w-12 h-12 bg-accent-green/15 rounded-lg flex items-center justify-center flex-shrink-0">
                  <Icon name="mdi:map-marker" class="w-6 h-6 text-accent-green" />
                </div>
                <div class="flex-1">
                  <div class="text-xs font-semibold text-theme-secondary mb-1 font-body uppercase tracking-wide">Location</div>
                  <div class="text-sm sm:text-base font-bold text-theme-primary font-body">
                    {siteData.address.city}, {siteData.address.country}
                  </div>
                </div>
              </div>

              <div class="flex items-center gap-4 p-4 sm:p-5 rounded-xl bg-accent-green/10 border border-accent-green/30">
                <div class="w-12 h-12 bg-accent-green/20 rounded-lg flex items-center justify-center flex-shrink-0">
                  <Icon name="mdi:clock-check-outline" class="w-6 h-6 text-accent-green" />
                </div>
                <div class="flex-1">
                  <div class="text-xs font-semibold text-theme-secondary mb-1 font-body uppercase tracking-wide">Response Time</div>
                  <div class="text-base sm:text-lg font-extrabold text-accent-green font-display">
                    {siteData.stats.responseTime}
                  </div>
                </div>
              </div>
            </div>

          </div>

          <div class="max-w-md mx-auto lg:mx-0 lg:max-w-none w-full" data-reveal="fade-left" data-reveal-delay="200" data-reveal-duration="500" data-reveal-easing="ease-out-cubic">
            <ContactForm />
          </div>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>


<script>
  import { setupSectionInit } from "@/scripts/sections/utils/initUtils";
  import { refreshWithDelay as refreshScrollAnimationsWithDelay } from "@/scripts/utils/scrollReveal";
  import { initEmailJS, handleContactFormSubmit, addRealTimeValidation } from "@/scripts/forms/emailHandler";
  import { initNotifications } from "@/scripts/utils/notifications";

  const currentPath = window.location.pathname;

  function initContactPage() {
    initEmailJS();
    initNotifications();

    const form = document.getElementById('contact-form-element') as HTMLFormElement;
    if (form && !form.dataset.initialized) {
      form.addEventListener('submit', handleContactFormSubmit);
      addRealTimeValidation(form);
      form.dataset.initialized = 'true';
    }
  }

  function refreshOnPageChange() {
    const newPath = window.location.pathname;
    if (newPath === currentPath) return;
    
    refreshScrollAnimationsWithDelay();
    if (newPath === '/contact/' || newPath === '/contact') {
      const form = document.getElementById('contact-form-element') as HTMLFormElement;
      if (form) form.removeAttribute('data-initialized');
      initContactPage();
    }
  }

  initContactPage();
  setupSectionInit(refreshOnPageChange);
</script>


